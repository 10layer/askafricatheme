<%= render :partial => 'general/localised_datepicker'  %>

<div id="list-filter">
	<%= form_tag(request.path, :method => "get", :id=>"filter_requests_form", :class=>"form-horizontal", :role=>"form") do %>
		<div class="form-group">
			<%= label_tag(:query, _("Keywords"), :class=>"form_label title col-sm-2 control-label") %>
			<div class="col-sm-10">
				<%= text_field_tag(:query, params[:query], :class=>"form-control") %>
			</div>
	 	</div>
		<% if false # don't think we want this, but leaving as an example %>
			<div class="list-filter-item">
				<%= _("Search for words in:") %> <br/>
				<% [["sent", _("messages from users")], 
			 		["response", _("messages from authorities")],
			 		["comment", _("comments")]].each_with_index do |item, index|
			 		variety, title = item %>
		 			<%= check_box_tag "request_variety[]", variety, params[:request_variety].nil? ? true : params[:request_variety].include?(variety), :id => "request_variety_#{index}" %>
					<%= label_tag("request_variety_#{index}", title) %> <br/>
				<% end %>
	 		</div>
		<% end %>
	 	<div class="list-filter-item form-group">
			<%= label_tag(:query, _("Made between"), :class=>"form_label title col-sm-2 control-label") %>
			<div class="col-sm-2">
				<%= text_field_tag(:request_date_after, params[:request_date_after], {:class => "use-datepicker form-control"}) %>&nbsp;&nbsp;
			</div>
			<%= label_tag(:query, _("and"), :class=>"form_label col-sm-1 control-label") %>
			<div class="col-sm-2">
				<%= text_field_tag(:request_date_before, params[:request_date_before], {:class => "use-datepicker form-control" }) %>
			</div>
		</div>
		<div class="list-filter-item form-group">
			<div class="col-sm-offset-2 col-sm-10">
				<%= submit_tag(_("Search"), :class=>"btn btn-primary") %>
			</div>
 		</div>
		<div class="list-filter-item form-group">
			<ul class="filter-request-types nav nav-pills">
				<% statuses = [["all", _("all requests")], 
					["successful", _("successful requests")],
					["unsuccessful", _("unsuccessful requests")],
					["awaiting", _("unresolved requests")]] %>
			 	<% for status, label in statuses %>
			 		<% if params[:view] != status %>
				 		<% if params[:controller] == "public_body" %>
							<li><%= link_to label, url_for(:controller => "public_body", :action => "show", :view => status, :url_name => @public_body.url_name) + "?" + request.query_string + '#results' %></li>
						<% else %>
							<li><%= link_to label, url_for(:controller => "request", :action => "list", :view => status) + "?" + request.query_string + '#results' %></li>
						<% end %>
					<% else %>
						<li class="active"><a href="#" class="active"><%= label %></a></li>
					<% end %>
					
				<% end %>
			</ul>
 		</div>
	<% end %>
</div>